#
# Copyright (c) 2015-2017, Chaos Software Ltd
#
# V-Ray For Houdini
#
# ACCESSIBLE SOURCE CODE WITHOUT DISTRIBUTION OF MODIFICATION LICENSE
#
# Full license text: https://github.com/ChaosGroup/vray-for-houdini/blob/master/LICENSE
#

if(WIN32)
	execute_process(
		COMMAND
			7z a -tzip -r ${INSTALL_RELEASE_ARCHIVE_FILEPATH} ${INSTALL_RELEASE_SUBDIR}
		WORKING_DIRECTORY
			${INSTALL_RELEASE_ROOT}
		OUTPUT_VARIABLE
			ARCHIVE_OUT
		ERROR_VARIABLE
			ARCHIVE_OUT
		RESULT_VARIABLE
			ARCHIVE_RESULT
	)
else()
	execute_process(
		COMMAND
			tar jcf ${INSTALL_RELEASE_ARCHIVE_FILEPATH} ${INSTALL_RELEASE_SUBDIR}
		WORKING_DIRECTORY
			${INSTALL_RELEASE_ROOT}
		OUTPUT_VARIABLE
			ARCHIVE_OUT
		ERROR_VARIABLE
			ARCHIVE_OUT
		RESULT_VARIABLE
			ARCHIVE_RESULT
	)
endif()
if ("${ARCHIVE_RESULT}" EQUAL 0 OR "${ARCHIVE_RESULT}" STREQUAL  "")
	message("${ARCHIVE_OUT}")
else()
	message(FATAL_ERROR "Packing failed:\n${ARCHIVE_OUT}")
endif()
